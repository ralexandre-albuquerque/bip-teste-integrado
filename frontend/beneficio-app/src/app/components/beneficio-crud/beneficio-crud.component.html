<div class="container mt-4">
  <div class="card">
    <div class="card-header">
      <h5 class="mb-0">Gerenciar Benefícios</h5>
    </div>
    <div class="card-body">
      <form [formGroup]="form" (ngSubmit)="submit()">
        <div class="row g-2">
          <div class="col-md-4">
            <input formControlName="nome" class="form-control" placeholder="Nome" />
            <div *ngIf="form.get('nome')?.touched && form.get('nome')?.invalid" class="text-danger small">Nome é obrigatório</div>
          </div>
          <div class="col-md-4">
            <input formControlName="descricao" class="form-control" placeholder="Descrição" />
          </div>
          <div class="col-md-2">
            <input formControlName="valor" type="number" class="form-control" min="0" step="0.01" placeholder="Valor" />
            <div *ngIf="form.get('valor')?.touched && form.get('valor')?.invalid" class="text-danger small">Valor inválido</div>
          </div>
          <div class="col-md-1 d-flex align-items-center">
            <div class="form-check">
              <input class="form-check-input" type="checkbox" formControlName="ativo" id="ativoCheck" />
              <label class="form-check-label" for="ativoCheck">Ativo</label>
            </div>
          </div>
          <div class="col-md-1 d-grid">
            <button class="btn btn-primary" [disabled]="submitting" type="submit">
              <span *ngIf="submitting" class="spinner-border spinner-border-sm me-2"></span>
              Incluir
            </button>
          </div>
        </div>
      </form>

      <div *ngIf="message" class="mt-3 alert" [ngClass]="isError ? 'alert-danger' : 'alert-success'">
        {{ message }}
      </div>

      <hr />

      <div *ngIf="loading" class="text-center my-3">
        <div class="spinner-border text-primary" role="status"></div>
      </div>

      <table *ngIf="!loading" class="table table-striped table-hover">
        <thead>
        <tr>
          <th>Nome</th>
          <th>Descrição</th>
          <th class="text-end">Valor</th>
          <th>Ativo</th>
          <th style="width:120px"></th>
        </tr>
        </thead>
        <tbody>
        <tr *ngFor="let b of beneficios">
          <td>{{ b.nome }}</td>
          <td>{{ b.descricao }}</td>
          <td class="text-end">R$ {{ formatted(b.valor) }}</td>
          <td>{{ b.ativo ? 'Sim' : 'Não' }}</td>
          <td class="text-end">
            <button class="btn btn-sm btn-danger" (click)="confirmDelete(b.id)" [disabled]="deletingId === b.id">
              <span *ngIf="deletingId === b.id" class="spinner-border spinner-border-sm"></span>
              Excluir
            </button>
          </td>
        </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>
